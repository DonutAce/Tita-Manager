<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Profile - Tita Manager</title>
    <meta name="description" content="Manage your profile and view your achievements">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="Styles/prof.css">
    <link rel="stylesheet" href="Styles/sidebar.css">
    <link rel="stylesheet" href="Styles/navbar.css">
    <link rel="icon" type="image/png" href="Images/icon-logo.png">
</head>

<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loader"></div>
        <p>Loading Profile...</p>
    </div>

    <div id="pageContent" class="js-hidden">
        <input type="checkbox" id="sidebar-toggle">

        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Tita Manager</h2>
                <label for="sidebar-toggle" class="close-btn">‚úï</label>
            </div>

            <div class="sidebar-nav">
                <a href="home.html" class="nav-link">üè† Home</a>
                <a href="profile.html" class="nav-link active">üë§ Profile</a>
                <a href="CTask.html" class="nav-link">‚ûï Create a Task</a>
                <a href="games.html" class="nav-link">üéÆ Games</a>
                <a href="feedback.html" class="nav-link">üí¨ Give Feedback</a>
                <a href="settings.html" class="nav-link">‚öôÔ∏è Settings</a>
                <a href="about.html" class="nav-link">‚ÑπÔ∏è About us</a>
                <a href="#" class="nav-link logout">üö™ Logout</a>
            </div>

            <div class="sidebar-footer">
                <p>Hello there!</p>
                <p>Hope you're having a great day!</p>
            </div>
        </div>

        <div class="main-content">
            <header class="header">
                <div class="header-left">
                    <label for="sidebar-toggle" class="menu-btn">‚ò∞ Menu</label>
                    <h1>Tita Manager</h1>
                </div>
                <div class="header-right">
                    <p>Profile</p>
                    <p>View your info</p>
                </div>
            </header>

            <main class="profile-container" id="profileMain">
                <!-- Profile Banner -->
                <section class="profile-banner">
                    <div class="banner-background" id="bannerBackground"></div>

                    <!-- Change banner button (opens color picker) -->
                    <button id="changeBannerBtn" title="Change banner color">Change Banner</button>
                    <input type="color" id="bannerColorPicker">

                    <div class="profile-info">
                        <div class="avatar-section">
                            <div class="avatar-wrapper">
                                <img src="Images/user.png" alt="Profile Avatar" class="avatar-image" id="profileImage">
                                <div class="level-badge" id="levelBadge">1</div>
                            </div>
                            <button class="edit-avatar-btn" id="editAvatarBtn"
                                title="Change profile picture">üì∑</button>
                            <input type="file" id="avatarInput" accept="image/*" style="visibility:hidden;">
                        </div>

                        <div class="user-details">
                            <h1 id="displayName">Name Holder</h1>

                            <p class="user-title">
                                <select id="titleSelect" aria-label="Title select">
                                    <option value="Student">Student</option>
                                    <option value="Developer">Developer</option>
                                    <option value="Learner">Learner</option>
                                    <option value="Other">Other</option>
                                </select>
                            </p>

                            <div class="user-stats">
                                <div class="stat">
                                    <span class="stat-value" id="xpValue">0</span>
                                    <span class="stat-label">Total XP</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="tasksValue">0</span>
                                    <span class="stat-label">Tasks Done</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="achievementsValue">0</span>
                                    <span class="stat-label">Achievements</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <div class="profile-content">
                    <section class="info-section">
                        <h2>üë§ Personal Information</h2>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Name:</span>
                                <span class="info-value" id="infoName">name holder</span>
                            </div>

                            <div class="info-item">
                                <span class="info-label">Email:</span>
                                <span class="info-value">
                                    <input id="emailInput" type="email" />
                                </span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Gender:</span>
                                <span class="info-value">
                                    <select id="genderSelect">
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                        <option value="Prefer Not to Say">Prefer Not to Say</option>
                                    </select>
                                </span>
                            </div>

                            <div class="info-item">
                                <span class="info-label">Birthday:</span>
                                <span class="info-value">
                                    <input id="birthdayInput" type="date" max="" />
                                </span>
                            </div>

                            <div class="info-item">
                                <span class="info-label">Age:</span>
                                <span class="info-value" id="ageValue">0</span>
                            </div>
                        </div>

                        <div class="info-actions">
                            <button id="saveInfoBtn">Edit</button>
                        </div>
                    </section>

                    <!-- Container 2: Game Statistics -->
                    <section class="info-section">
                        <h2>üìë Statistics</h2>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Total XP:</span>
                                <span class="info-value" id="statXP">0</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Task Done:</span>
                                <span class="info-value" id="statTasks">0</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Achievements:</span>
                                <span class="info-value" id="statAchievements">0</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Rank:</span>
                                <span class="info-value" id="statRank">Unranked</span>
                            </div>
                        </div>
                    </section>

                    <!-- Progress Section -->
                    <section class="progress-section">
                        <h2>üìà Progress Overview</h2>
                        <div class="progress-cards">
                            <div class="progress-card">
                                <h3>Current Level</h3>
                                <div class="level-progress">
                                    <div class="level-bar">
                                        <div class="level-fill" id="levelFill" style="width:0%"></div>
                                    </div>
                                    <span class="level-text" id="levelText">Level 1 ‚Ä¢ 0/100 XP to next level</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Achievements Section -->
                    <section class="achievements-section">
                        <h2>üèÜ Achievements</h2>
                        <div class="achievements-grid" id="achievementsGrid">
                        </div>

                        <div class="see-more-wrapper">
                            <button id="seeMoreBtn">See More</button>
                        </div>
                    </section>
                </div>
            </main>
        </div>

        <!-- Achievements modal -->
        <div id="achModal" class="ach-modal" aria-hidden="true">
            <div class="ach-modal-content">
                <h2>All Achievements</h2>
                <div id="allAchievementsList" class="all-ach-list"></div>
                <div class="ach-modal-actions">
                    <button id="closeAchModal" class="ach-close-btn">Close</button>
                </div>
            </div>
        </div>

        <div class="overlay" id="pageOverlay"></div>
    </div>

    <script type="module" src="js/profile.js"></script>

    <script>
        // fallback: if profile.js doesn't fire profileLoaded for some reason, reveal after 15s
        // profile.js's hidePageUntilReady() will normally show the page and hide the loader
        setTimeout(() => {
            const loading = document.getElementById("loadingScreen");
            const content = document.getElementById("pageContent");
            if (loading && content && loading.style.display !== "none") {
                loading.style.display = "none";
                content.style.display = "block";
                console.warn("Fallback: showing page after 15s.");
            }
        }, 15000);
    </script>
    <script type="module" src="./js/theme.js"></script>
    <script type="module" src="./js/auth-check.js"></script>


</body>

</html>